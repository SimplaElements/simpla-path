!function(){"use strict";var t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),n=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},a=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},i=Array.prototype.forEach,o=function(){function n(e){if(t(this,n),!e)throw new Error("Must be given a document");this.ownerDocument=e,this._attrMap=new Map,this._elementMap=new WeakMap,this._observe()}return e(n,[{key:"define",value:function(t,e){this._attrMap.set(t,e),this._upgradeAttr(t)}},{key:"get",value:function(t,e){var n=this._elementMap.get(t);if(n)return n.get(e)}},{key:"_getConstructor",value:function(t){return this._attrMap.get(t)}},{key:"_observe",value:function(){var t=this,e=this.ownerDocument,n=this._downgrade.bind(this),r=this._upgradeElement.bind(this);this.observer=new MutationObserver(function(e){i.call(e,function(e){if("attributes"===e.type){var a=t._getConstructor(e.attributeName);a&&t._found(e.attributeName,e.target,e.oldValue)}else i.call(e.removedNodes,n),i.call(e.addedNodes,r)})}),this.observer.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0})}},{key:"_upgradeAttr",value:function(t,e){e=e||this.ownerDocument;var n=e.querySelectorAll("["+t+"]"),r=!0,a=!1,i=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value;this._found(t,l)}}catch(t){a=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}}},{key:"_upgradeElement",value:function(t){if(1===t.nodeType){var e=!0,n=!1,r=void 0;try{for(var a,i=t.attributes[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var o=a.value;this._getConstructor(o.name)&&this._found(o.name,t)}}catch(t){n=!0,r=t}finally{try{!e&&i.return&&i.return()}finally{if(n)throw r}}var u=!0,l=!1,c=void 0;try{for(var h,s=this._attrMap.keys()[Symbol.iterator]();!(u=(h=s.next()).done);u=!0){var o=h.value;this._upgradeAttr(o,t)}}catch(t){l=!0,c=t}finally{try{!u&&s.return&&s.return()}finally{if(l)throw c}}}}},{key:"_downgrade",value:function(t){var e=this._elementMap.get(t);if(e){var n=!0,r=!1,a=void 0;try{for(var i,o=e.values()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;u.disconnectedCallback&&u.disconnectedCallback()}}catch(t){r=!0,a=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}this._elementMap.delete(t)}}},{key:"_found",value:function(t,e,n){var r=this._elementMap.get(e);r||(r=new Map,this._elementMap.set(e,r));var a=r.get(t),i=e.getAttribute(t);if(a)null==i&&a.value?(a.value=i,a.disconnectedCallback&&a.disconnectedCallback(),r.delete(t)):i!==a.value&&(a.value=i,a.changedCallback&&a.changedCallback(n,i));else{var o=this._getConstructor(t);a=new o,r.set(t,a),a.ownerElement=e,a.name=t,a.value=i,a.connectedCallback&&a.connectedCallback()}}}]),n}(),u="/",l="path",c=u,h="sid",s="gid",f=new RegExp("^\\"+u+"*(.+?)\\"+u+"*$"),d=function(t){return function(e){return e!==t}},p=function(t){return t===u?"":t.replace(f,"$1")},v=function(){function n(){t(this,n),this.children=[]}return e(n,[{key:"addChild",value:function(t){var e=void 0;t.parent!==this&&(e=this.children,this.children=[].concat(a(e),[t]),t.parent=this,e.forEach(function(t){return t.findAndAttachToParent()}))}},{key:"removeChild",value:function(t){this.children=this.children.filter(d(t)),t.parent=null}},{key:"refreshPath",value:function(){var t=[];this.parent&&this.parent.path&&t.push(this.parent.path),this.partial&&t.push(this.partial),this.path=t.join(u)}},{key:"pluck",value:function(){var t=this.parent,e=this.children;this.parent=null,this.children=[],e.forEach(t.addChild,t)}},{key:"findAndAttachToParent",value:function(){}},{key:"path",set:function(t){this._path=t,this.children.forEach(function(t){return t.refreshPath()})},get:function(){return this._path}},{key:"parent",set:function(t){this._parent=t,this.refreshPath()},get:function(){return this._parent}},{key:"partial",set:function(t){this._partial=t,this.refreshPath()},get:function(){return this._partial}}]),n}(),y=function(a,i){return function(o){function u(){return t(this,u),r(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return n(u,o),e(u,[{key:"connectedCallback",value:function(){this.findAndAttachToParent(),this.syncValueToPartial(),this.syncPathToOwnerElement()}},{key:"disconnectedCallback",value:function(){this.pluck(),this.syncValueToPartial(),this.syncPathToOwnerElement()}},{key:"changedCallback",value:function(){this.syncValueToPartial(),this.syncPathToOwnerElement()}},{key:"findAndAttachToParent",value:function(){var t=void 0,e=void 0;do t=t?t.parentElement:this.ownerElement.parentElement,e=a(t);while(t&&!e);e?e.addChild(this):i.addChild(this)}},{key:"syncValueToPartial",value:function(){this.partial=this.value}},{key:"syncPathToOwnerElement",value:function(){var t=c+this.path,e=new CustomEvent("path-changed",{detail:{value:t}});this.ownerElement[l]=t,this.ownerElement.dispatchEvent(e),this.children.forEach(function(t){return t.syncPathToOwnerElement()})}}]),u}(v)},b=function(a,i){return function(a){function i(){return t(this,i),r(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return n(i,a),e(i,[{key:"refreshPath",value:function(){this.path=this.partial||""}}]),i}(y(a,i))};window.SimplaPaths={observe:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=new o(t),r=new v,a=function(t){return!!t},i=function(t){return function(e){return n.get(t,e)}},u=function(t){return[s,h].map(i(t)).find(a)};r.partial=p(e),n.define(h,y(u,r)),n.define(s,b(u,r))}},window.SimplaPaths.observe(document)}();